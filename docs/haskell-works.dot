digraph haskell_works {
    label="haskell-works Package Dependencies";
    labelloc=t;
    fontname="Helvetica";
    fontsize=16;

    rankdir=BT;  // Bottom to top (dependencies flow upward)
    node [shape=box, style="rounded,filled", fontname="Helvetica", fontsize=11];
    edge [color="#666666"];

    // Color scheme by layer
    // Layer 0 - Foundation (no hw-* deps): light blue
    // Layer 1 - Minimal deps: light green
    // Layer 2 - Building blocks: light yellow
    // Layer 3 - SIMD layer: light orange
    // Layer 4 - Applications: light purple

    // ===========================================
    // Layer 0 - Foundation (no hw-* dependencies)
    // ===========================================
    subgraph cluster_layer0 {
        label="Foundation (no hw-* deps)";
        style=dashed;
        color="#999999";

        hw_aeson [label="hw-aeson\n0.1.8.0", fillcolor="#d4e6f1"];
        hw_hspec_hedgehog [label="hw-hspec-hedgehog\n0.1.1.1", fillcolor="#d4e6f1"];
        hw_string_parse [label="hw-string-parse\n0.0.0.5", fillcolor="#d4e6f1"];
        hw_prelude [label="hw-prelude\n0.0.4.1", fillcolor="#d4e6f1"];
    }

    // ===========================================
    // Layer 1 - Minimal dependencies
    // ===========================================
    subgraph cluster_layer1 {
        label="Core";
        style=dashed;
        color="#999999";

        hw_prim [label="hw-prim\n0.6.3.2", fillcolor="#d5f5e3"];
        hw_mquery [label="hw-mquery\n0.2.1.1", fillcolor="#d5f5e3"];
        hw_json_simd [label="hw-json-simd\n0.1.1.2\n(x86_64 only)", fillcolor="#d5f5e3"];
        hw_polysemy [label="hw-polysemy\n0.3.1.2", fillcolor="#d5f5e3"];
    }

    // ===========================================
    // Layer 2 - Building blocks
    // ===========================================
    subgraph cluster_layer2 {
        label="Building Blocks";
        style=dashed;
        color="#999999";

        hw_bits [label="hw-bits\n0.7.2.2", fillcolor="#fcf3cf"];
    }

    // ===========================================
    // Layer 3 - SIMD/Performance layer
    // ===========================================
    subgraph cluster_layer3 {
        label="SIMD Layer";
        style=dashed;
        color="#999999";

        hw_simd [label="hw-simd\n0.1.2.2\n(x86_64 only)", fillcolor="#fdebd0"];
    }

    // ===========================================
    // Layer 4 - High-level parsers (Applications)
    // ===========================================
    subgraph cluster_layer4 {
        label="Applications";
        style=dashed;
        color="#999999";

        hw_dsv [label="hw-dsv\n0.4.1.2\nDSV/CSV Parser", fillcolor="#e8daef"];
        hw_json [label="hw-json\n1.3.3.0\nJSON Parser", fillcolor="#e8daef"];
        hw_xml [label="hw-xml\n0.5.1.2\nXML Parser", fillcolor="#e8daef"];
    }

    // ===========================================
    // External hw-* packages (not in analyzed set)
    // ===========================================
    subgraph cluster_external {
        label="External hw-* packages\n(not analyzed)";
        style=dashed;
        color="#cccccc";
        node [fillcolor="#f5f5f5", style="rounded,filled,dashed"];

        hw_rankselect [label="hw-rankselect"];
        hw_rankselect_base [label="hw-rankselect-base"];
        hw_balancedparens [label="hw-balancedparens"];
        hw_parser [label="hw-parser"];
        hw_int [label="hw-int"];
        hw_json_simple_cursor [label="hw-json-simple-cursor"];
        hw_json_standard_cursor [label="hw-json-standard-cursor"];
    }

    // ===========================================
    // Dependencies
    // ===========================================

    // Layer 1 dependencies
    hw_prim -> hw_hspec_hedgehog [style=dashed, color="#aaaaaa", label="test"];
    hw_mquery -> hw_hspec_hedgehog [style=dashed, color="#aaaaaa", label="test"];
    hw_json_simd -> hw_prim;
    hw_polysemy -> hw_prelude;

    // Layer 2 dependencies
    hw_bits -> hw_prim;
    hw_bits -> hw_string_parse;
    hw_bits -> hw_int;
    hw_bits -> hw_hspec_hedgehog [style=dashed, color="#aaaaaa", label="test"];

    // Layer 3 dependencies
    hw_simd -> hw_bits;
    hw_simd -> hw_prim;
    hw_simd -> hw_rankselect;
    hw_simd -> hw_rankselect_base;
    hw_simd -> hw_hspec_hedgehog [style=dashed, color="#aaaaaa", label="test"];

    // Layer 4 dependencies
    // hw-dsv
    hw_dsv -> hw_bits;
    hw_dsv -> hw_prim;
    hw_dsv -> hw_simd;
    hw_dsv -> hw_rankselect;
    hw_dsv -> hw_rankselect_base;
    hw_dsv -> hw_hspec_hedgehog [style=dashed, color="#aaaaaa", label="test"];

    // hw-json
    hw_json -> hw_bits;
    hw_json -> hw_prim;
    hw_json -> hw_mquery;
    hw_json -> hw_simd [label="x86_64"];
    hw_json -> hw_json_simd [label="x86_64"];
    hw_json -> hw_balancedparens;
    hw_json -> hw_parser;
    hw_json -> hw_rankselect;
    hw_json -> hw_rankselect_base;
    hw_json -> hw_json_simple_cursor;
    hw_json -> hw_json_standard_cursor;
    hw_json -> hw_hspec_hedgehog [style=dashed, color="#aaaaaa", label="test"];

    // hw-xml
    hw_xml -> hw_bits;
    hw_xml -> hw_prim;
    hw_xml -> hw_balancedparens;
    hw_xml -> hw_parser;
    hw_xml -> hw_rankselect;
    hw_xml -> hw_rankselect_base;
    hw_xml -> hw_hspec_hedgehog [style=dashed, color="#aaaaaa", label="test"];
}
